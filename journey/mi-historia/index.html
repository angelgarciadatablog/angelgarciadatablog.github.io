<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Mi Historia - angelgarciadatablog</title>
  <meta name="description" content="Mi camino en el mundo del an√°lisis de datos: c√≥mo empec√© y hacia d√≥nde voy.">
  <link rel="stylesheet" href="../../styles.css">
  <link rel="icon" type="image/png" href="../../img/favicon.png">
  <meta name="theme-color" content="#0a0a0a">

  <style>
    /* Fix mobile menu */
    .site-header {
      position: relative;
    }

    /* Center footer content - only on mobile */
    @media (max-width: 768px) {
      .site-footer .footer-inner {
        text-align: center;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1rem;
      }

      .site-footer .social {
        justify-content: center;
      }
    }

    /* Remove default spacing */
    .site-main {
      padding: 0 !important;
      margin: 0 !important;
    }

    /* Timeline Container - HERO SECTION */
    .timeline-section {
      padding: 40px 0 40px;
      margin: 0;
      min-height: calc(100vh - 60px);
      overflow: visible;
    }

    .timeline-section .container {
      padding: 0;
      max-width: 100%;
      width: 100%;
    }

    /* Header Section */
    .timeline-header {
      text-align: center;
      margin-bottom: 10px;
      padding: 0 20px;
    }

    .timeline-title {
      font-size: 3rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      line-height: 1.2;
    }

    .timeline-subtitle {
      font-size: 1.125rem;
      color: var(--text-secondary);
      max-width: 600px;
      margin: 0 auto 0;
      line-height: 1.6;
    }

    .timeline-wrapper {
      position: relative;
      width: 100%;
      padding: 0;
      margin: 0;
    }

    .timeline-container {
      position: relative;
      width: 100%;
      overflow-x: auto;
      overflow-y: visible;
      padding: 0 20px;
      margin: 0;
    }

    /* Hide scrollbar but keep functionality */
    .timeline-container::-webkit-scrollbar {
      height: 0;
      display: none;
    }

    .timeline-track {
      position: relative;
      min-width: 1800px;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      gap: 100px;
      padding: 0 20px;
      margin: 0;
    }

    /* SVG Layer for connections */
    .timeline-svg {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
    }

    .timeline-svg path {
      fill: none;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
    }

    .timeline-svg path.past {
      stroke: rgba(124, 58, 237, 0.6);
    }

    .timeline-svg path.future {
      stroke: rgba(128, 128, 128, 0.3);
    }

    /* Timeline Items - Simple columns left to right */
    .timeline-column {
      display: flex;
      flex-direction: column;
      gap: 60px;
      align-items: center;
      justify-content: center;
      position: relative;
      flex-shrink: 0;
    }

    .timeline-item {
      position: relative;
      z-index: 2;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      max-width: 180px;
      flex-shrink: 0;
    }

    /* Navigation Buttons - Bottom */
    .timeline-nav {
      display: flex !important;
      justify-content: center;
      gap: 20px;
      margin-top: 60px;
      padding: 20px 0;
      z-index: 100;
      position: relative;
    }

    .timeline-nav-btn {
      background: var(--card-bg);
      border: 1px solid var(--border);
      color: var(--text);
      min-width: 140px;
      padding: 14px 28px;
      border-radius: var(--radius);
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 500;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-size: 1rem;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }

    .timeline-nav-btn:hover {
      border-color: var(--muted);
      background: var(--card-bg);
      color: var(--text);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      transform: translateY(-1px);
    }

    .timeline-nav-btn:active {
      transform: translateY(0);
    }

    .timeline-item.future .timeline-card {
      opacity: 0.6;
      filter: grayscale(0.3);
    }

    /* Timeline Dot - Numbered circle */
    .timeline-dot {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      border: 2px solid #7c3aed;
      background: #7c3aed;
      z-index: 3;
      transition: all 0.3s ease;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 1.1rem;
      color: #fff;
      cursor: pointer;
      flex-shrink: 0;
    }

    .timeline-item.past .timeline-dot {
      background: #7c3aed;
      border-color: #7c3aed;
      box-shadow: 0 0 20px rgba(124, 58, 237, 0.6);
    }

    .timeline-item.future .timeline-dot {
      background: #374151;
      border-color: #4b5563;
      color: #9ca3af;
      opacity: 0.5;
      box-shadow: none;
    }

    .timeline-item:hover .timeline-dot {
      transform: scale(1.15);
    }

    .timeline-item.past:hover .timeline-dot {
      box-shadow: 0 0 30px rgba(124, 58, 237, 0.8);
    }

    .timeline-item.future:hover .timeline-dot {
      box-shadow: 0 0 15px rgba(128, 128, 128, 0.3);
    }

    /* Timeline Date Label - Always visible */
    .timeline-date {
      font-size: 0.7rem;
      font-weight: 600;
      color: #7c3aed !important;
      background: none !important;
      -webkit-background-clip: unset !important;
      -webkit-text-fill-color: #7c3aed !important;
      background-clip: unset !important;
      margin-top: 6px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      text-align: center;
      white-space: nowrap;
    }

    .timeline-item.future .timeline-date {
      color: #6b7280 !important;
      -webkit-text-fill-color: #6b7280 !important;
    }

    /* Timeline Title - Always visible below date */
    .timeline-title-label {
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--text);
      margin-top: 6px;
      text-align: center;
      line-height: 1.2;
      max-width: 160px;
    }

    .timeline-item.future .timeline-title-label {
      color: var(--text-secondary);
      opacity: 0.6;
    }

    /* Timeline Card - Hidden by default, shown on hover */
    .timeline-card {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: 1.25rem;
      width: 280px;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      cursor: pointer;
      z-index: 10;
      pointer-events: none;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    }

    .timeline-item:hover .timeline-card {
      opacity: 1;
      visibility: visible;
      transform: translate(-50%, -50%) scale(1);
      pointer-events: auto;
      border-color: #7c3aed;
    }

    .timeline-card-title {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: var(--text);
      line-height: 1.3;
    }

    .timeline-card-description {
      font-size: 0.85rem;
      color: var(--text-secondary);
      line-height: 1.5;
    }

    .timeline-type-badge {
      display: inline-block;
      font-size: 0.7rem;
      padding: 0.25rem 0.65rem;
      border-radius: 10px;
      background: var(--surface);
      color: var(--text-secondary);
      margin-top: 0.75rem;
      text-transform: capitalize;
    }

    /* Mobile Timeline - Vertical */
    @media (max-width: 768px) {
      .timeline-section {
        padding: 30px 0;
      }

      .timeline-header {
        margin-bottom: 30px;
      }

      .timeline-title {
        font-size: 2rem;
      }

      .timeline-subtitle {
        font-size: 1rem;
        padding: 0 20px;
      }

      .timeline-container {
        overflow-x: visible;
        padding: 0;
        min-height: auto;
      }

      .timeline-track {
        display: flex;
        flex-direction: column;
        min-width: 100%;
        padding: 0 20px;
        position: relative;
        gap: 0;
      }

      .timeline-column {
        display: contents;
      }

      /* Vertical line connecting all items */
      .timeline-svg {
        position: absolute !important;
        left: 30px !important;
        top: 0 !important;
        width: 4px !important;
        height: 100% !important;
      }

      .timeline-svg path {
        stroke: rgba(124, 58, 237, 0.4) !important;
        stroke-width: 2 !important;
      }

      .timeline-item {
        width: 100%;
        display: grid;
        grid-template-columns: 60px 1fr;
        grid-template-rows: auto auto auto;
        gap: 0;
        position: relative;
        margin-bottom: 50px !important;
        max-width: 100%;
        cursor: pointer;
      }

      .timeline-item:last-child {
        margin-bottom: 0 !important;
      }

      /* Left side: dot with icon - spans all rows */
      .timeline-dot {
        position: relative;
        margin: 0;
        width: 60px;
        height: 60px;
        font-size: 0;
        flex-shrink: 0;
        background: #7c3aed;
        border: 4px solid #1a1a1a;
        box-shadow: 0 0 0 2px #7c3aed;
        z-index: 10;
        grid-row: 1 / 4;
        grid-column: 1;
      }

      .timeline-item.future .timeline-dot {
        background: #4b5563;
        border-color: #1a1a1a;
        box-shadow: 0 0 0 2px #4b5563;
        opacity: 1;
      }

      /* Hide number, show icon instead */
      .timeline-dot::after {
        content: '‚úì';
        font-size: 1.5rem;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        height: 100%;
      }

      .timeline-item.future .timeline-dot::after {
        content: '‚óá';
        font-size: 1.3rem;
      }

      /* Right side: Date (row 1) */
      .timeline-date {
        grid-column: 2;
        grid-row: 1;
        margin: 0 0 4px 0;
        padding-left: 20px;
        text-align: left;
        font-size: 0.9rem;
        color: #7c3aed !important;
        -webkit-text-fill-color: #7c3aed !important;
        font-weight: 700;
        letter-spacing: 0.05em;
        text-transform: uppercase;
      }

      .timeline-item.future .timeline-date {
        color: #6b7280 !important;
        -webkit-text-fill-color: #6b7280 !important;
      }

      /* Right side: Title (row 2) */
      .timeline-item .timeline-title-label {
        grid-column: 2;
        grid-row: 2;
        margin: 0;
        padding-left: 20px;
        text-align: left;
        font-size: 1rem;
        max-width: calc(100vw - 100px);
        font-weight: 400 !important;
        line-height: 1.4;
        color: var(--text);
      }

      .timeline-item.future .timeline-title-label {
        color: var(--text-secondary);
        font-weight: 400 !important;
      }

      /* Mobile: hide description by default, show on click */
      .timeline-card {
        grid-column: 2;
        grid-row: 3;
        position: relative;
        top: auto;
        left: auto;
        transform: none;
        opacity: 0;
        visibility: hidden;
        max-height: 0;
        overflow: hidden;
        width: auto;
        max-width: calc(100vw - 100px);
        background: transparent;
        border: none;
        border-radius: 8px;
        padding: 0;
        margin: 0;
        margin-left: 20px;
        box-shadow: none;
        pointer-events: none;
        transition: all 0.3s ease;
      }

      .timeline-item.active .timeline-card {
        opacity: 1;
        visibility: visible;
        max-height: 500px;
        margin-top: 12px;
        margin-bottom: 8px;
        padding: 12px 16px;
        pointer-events: auto;
        background: rgba(30, 30, 30, 0.95);
        border: 1px solid rgba(124, 58, 237, 0.3);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
      }

      .timeline-card-title {
        display: none;
      }

      .timeline-card-description {
        font-size: 0.875rem;
        color: var(--text-secondary);
        line-height: 1.6;
        margin: 0;
      }

      .timeline-type-badge {
        display: none;
      }

      /* Navigation buttons - hide on mobile */
      .timeline-nav {
        display: none !important;
      }
    }

    /* Navigation Buttons - Hidden on desktop */
    .timeline-nav {
      display: none;
    }

    /* Loading State */
    .timeline-loading {
      text-align: center;
      padding: 4rem 1rem;
      color: var(--text-secondary);
    }

    .timeline-loading-spinner {
      width: 48px;
      height: 48px;
      border: 3px solid var(--border);
      border-top-color: #7c3aed;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 1rem;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a class="brand" href="/">Angel Garc√≠a</a>
      <button class="menu-toggle" aria-label="Abrir men√∫" aria-controls="site-menu" aria-expanded="false">
        <span aria-hidden="true">‚ò∞</span>
      </button>
      <nav class="menu" id="site-menu">
        <a class="menu-link" href="/">Inicio</a>
        <a class="menu-link" href="https://www.youtube.com/@angelgarciadatablog" target="_blank" rel="noopener noreferrer">Youtube</a>
        <a class="menu-link" href="https://github.com/angelgarciadatablog" target="_blank" rel="noopener noreferrer">Github</a>
        <a class="menu-link" href="https://www.linkedin.com/in/angelgarciachanga/" target="_blank" rel="noopener noreferrer">Linkedin</a>
      </nav>
    </div>
  </header>

  <main class="site-main">
    <section class="timeline-section">
      <div class="container">
        <div class="timeline-header">
          <h1 class="timeline-title">
            <span class="gradient-text">Mi Historia</span>
          </h1>
          <p class="timeline-subtitle">
            Un recorrido por mi camino en el mundo del an√°lisis de datos
          </p>
        </div>

        <div class="timeline-wrapper">
          <div id="timeline-container" class="timeline-container">
            <div class="timeline-loading">
              <div class="timeline-loading-spinner"></div>
              <p>Cargando l√≠nea de tiempo...</p>
            </div>
          </div>

          <div class="timeline-nav">
            <button class="timeline-nav-btn" onclick="scrollTimeline('left')">
              <span>‚Üê</span> Anterior
            </button>
            <button class="timeline-nav-btn" onclick="scrollTimeline('right')">
              Siguiente <span>‚Üí</span>
            </button>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container footer-inner">
      <div class="social">
        <a aria-label="LinkedIn" href="https://www.linkedin.com/in/angelgarciachanga/" target="_blank" rel="noopener noreferrer" class="icon-link">
          <svg viewBox="0 0 24 24" width="22" height="22" fill="currentColor" aria-hidden="true"><path d="M4.98 3.5C4.98 4.88 3.86 6 2.5 6S0 4.88 0 3.5 1.12 1 2.5 1 4.98 2.12 4.98 3.5zM.5 8.5h4V24h-4zM8.5 8.5h3.8v2.1h.05c.53-1 1.82-2.1 3.75-2.1 4 0 4.74 2.63 4.74 6V24h-4v-7.1c0-1.7-.03-3.9-2.38-3.9-2.38 0-2.75 1.86-2.75 3.78V24h-4z"/></svg>
        </a>
        <a aria-label="Instagram" href="https://www.instagram.com/agl.garcia86/" target="_blank" rel="noopener noreferrer" class="icon-link">
          <svg viewBox="0 0 24 24" width="22" height="22" fill="currentColor" aria-hidden="true"><path d="M7 2C4.24 2 2 4.24 2 7v10c0 2.76 2.24 5 5 5h10c2.76 0 5-2.24 5-5V7c0-2.76-2.24-5-5-5H7zm10 2a3 3 0 0 1 3 3v10a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V7a3 3 0 0 1 3-3h10zm-5 3.5A5.5 5.5 0 1 0 17.5 13 5.5 5.5 0 0 0 12 7.5zm0 2A3.5 3.5 0 1 1 8.5 13 3.5 3.5 0 0 1 12 9.5zM18 6.25a1.25 1.25 0 1 0 1.25 1.25A1.25 1.25 0 0 0 18 6.25z"/></svg>
        </a>
        <a aria-label="YouTube" href="https://www.youtube.com/@angelgarciadatablog" target="_blank" rel="noopener noreferrer" class="icon-link">
          <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor" aria-hidden="true"><path d="M23.5 6.2s-.2-1.6-.8-2.3c-.8-.8-1.7-.8-2.1-.9C17.8 2.7 12 2.7 12 2.7h0s-5.8 0-8.6.3c-.4 0-1.4.1-2.1.9C.7 4.6.5 6.2.5 6.2S.3 8.1.3 9.9v1.7c0 1.8.2 3.7.2 3.7s.2 1.6.8 2.3c.8.8 1.9.8 2.4.9 1.8.2 7.7.3 7.7.3s5.8 0 8.6-.3c.4 0 1.4-.1 2.1-.9.6-.7.8-2.3.8-2.3s.2-1.8.2-3.7V9.9c0-1.8-.2-3.7-.2-3.7zM9.8 14.6V7.7l6.2 3.5-6.2 3.4z"/></svg>
        </a>
        <a aria-label="GitHub" href="https://github.com/angelgarciadatablog" target="_blank" rel="noopener noreferrer" class="icon-link">
          <svg viewBox="0 0 24 24" width="22" height="22" fill="currentColor" aria-hidden="true"><path d="M12 .5a12 12 0 0 0-3.8 23.4c.6.1.8-.3.8-.6v-2c-3.4.7-4.1-1.6-4.1-1.6-.5-1.2-1.2-1.6-1.2-1.6-1-.7.1-.7.1-.7 1.1.1 1.7 1.1 1.7 1.1 1 .1 2 .7 2 .7 1.8 1.2 3.9.9 4.9.7.2-.8.7-1.2 1.2-1.5-2.7-.3-5.5-1.4-5.5-6.1 0-1.3.5-2.5 1.2-3.4-.1-.3-.5-1.6.1-3.3 0 0 1-.3 3.4 1.3 1-.3 2.2-.4 3.3-.4s2.3.2 3.3.4c2.3-1.6 3.4-1.3 3.4-1.3.6 1.7.2 3 .1 3.3.8.9 1.2 2.1 1.2 3.4 0 4.7-2.8 5.8-5.5 6.1.7.6 1.3 1.8 1.3 3.7v2.8c0 .3.2.7.8.6A12 12 0 0 0 12 .5z"/></svg>
        </a>
      </div>
      <p>¬© 2025 Angel Garc√≠a. Todos los derechos reservados.</p>
    </div>
  </footer>

  <script src="../../js/googleSheets.js"></script>
  <script>
    // Get current date
    const currentDate = new Date();
    const currentYear = currentDate.getFullYear();
    const currentMonth = currentDate.getMonth() + 1;

    // Format date
    function formatDate(dateString) {
      const [year, month] = dateString.split('-');
      const monthNames = ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'];
      return `${monthNames[parseInt(month) - 1]} ${year}`;
    }

    // Check if past
    function isPastDate(dateString) {
      const [year, month] = dateString.split('-').map(Number);
      if (year < currentYear) return true;
      if (year === currentYear && month <= currentMonth) return true;
      return false;
    }

    // Load timeline
    async function loadTimeline() {
      try {
        console.log('üìä Cargando l√≠nea de tiempo desde Google Sheets...');

        // Obtener datos del Google Sheet (usa cach√© autom√°ticamente)
        const data = await GoogleSheets.getLineaTiempo();

        if (!data || data.length === 0) {
          throw new Error('No se obtuvieron datos de la l√≠nea de tiempo');
        }

        console.log(`‚úÖ ${data.length} hitos cargados`);

        // Transformar los datos al formato esperado
        const milestones = data.map((row, index) => ({
          id: parseInt(row.ID || row.id) || (index + 1),
          date: row.Fecha || row.fecha || row.date || '',
          title: row.T√≠tulo || row.titulo || row.title || '',
          description: row.Descripci√≥n || row.descripcion || row.description || '',
          type: row.Tipo || row.tipo || row.type || 'milestone'
        }));

        renderTimeline(milestones);
      } catch (error) {
        console.error('‚ùå Error cargando timeline:', error);
        showError();
      }
    }

    function renderTimeline(milestones) {
      const container = document.getElementById('timeline-container');
      const isMobile = window.innerWidth <= 768;

      let html;

      if (isMobile) {
        // Mobile: render all items in a single vertical list
        const itemsHtml = milestones.map((m, index) => `
          <div class="timeline-item ${isPastDate(m.date) ? 'past' : 'future'}" data-index="${index}">
            <div class="timeline-dot">${index + 1}</div>
            <div class="timeline-date">${formatDate(m.date)}</div>
            <div class="timeline-title-label">${m.title}</div>
            <div class="timeline-card">
              <h3 class="timeline-card-title">${m.title}</h3>
              <p class="timeline-card-description">${m.description}</p>
              <span class="timeline-type-badge">${m.type}</span>
            </div>
          </div>
        `).join('');

        html = `
          <div class="timeline-track">
            <svg class="timeline-svg" xmlns="http://www.w3.org/2000/svg"></svg>
            ${itemsHtml}
          </div>
        `;
      } else {
        // Desktop: distribute items across columns
        const columns = [];
        let currentIndex = 0;
        const totalItems = milestones.length;

        while (currentIndex < totalItems) {
          // Alternate between 3 and 2 items per column for better visual balance
          const itemsInThisColumn = (columns.length % 2 === 0) ? Math.min(3, totalItems - currentIndex) : Math.min(2, totalItems - currentIndex);

          const columnItems = [];
          for (let i = 0; i < itemsInThisColumn; i++) {
            if (currentIndex < totalItems) {
              columnItems.push(currentIndex);
              currentIndex++;
            }
          }

          if (columnItems.length > 0) {
            columns.push(columnItems);
          }
        }

        const columnsHtml = columns.map((colItems, colIndex) => `
          <div class="timeline-column">
            ${colItems.map(index => {
              const m = milestones[index];
              return `
                <div class="timeline-item ${isPastDate(m.date) ? 'past' : 'future'}" data-index="${index}">
                  <div class="timeline-dot">${index + 1}</div>
                  <div class="timeline-date">${formatDate(m.date)}</div>
                  <div class="timeline-title-label">${m.title}</div>
                  <div class="timeline-card">
                    <h3 class="timeline-card-title">${m.title}</h3>
                    <p class="timeline-card-description">${m.description}</p>
                    <span class="timeline-type-badge">${m.type}</span>
                  </div>
                </div>
              `;
            }).join('')}
          </div>
        `).join('');

        html = `
          <div class="timeline-track">
            <svg class="timeline-svg" xmlns="http://www.w3.org/2000/svg"></svg>
            ${columnsHtml}
          </div>
        `;
      }

      container.innerHTML = html;

      // Add click handlers for mobile (toggle description)
      if (window.innerWidth <= 768) {
        const items = document.querySelectorAll('.timeline-item');
        items.forEach(item => {
          item.addEventListener('click', function(e) {
            // Don't toggle if clicking on a link
            if (e.target.tagName === 'A') return;

            // Toggle active class
            this.classList.toggle('active');
          });
        });
      }

      // Generate curved connectors after DOM update
      setTimeout(() => {
        if (window.innerWidth > 768) {
          generateCurvedConnectors(milestones);
        } else {
          generateVerticalConnectors(milestones);
        }
      }, 100);

      // Regenerate on resize
      let resizeTimeout;
      let lastWidth = window.innerWidth;
      window.addEventListener('resize', () => {
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(() => {
          const currentWidth = window.innerWidth;
          const wasDesktop = lastWidth > 768;
          const isDesktop = currentWidth > 768;

          // If switching between mobile/desktop, re-render completely
          if (wasDesktop !== isDesktop) {
            renderTimeline(milestones);
          } else {
            // Just regenerate connectors
            if (window.innerWidth > 768) {
              generateCurvedConnectors(milestones);
            } else {
              generateVerticalConnectors(milestones);
            }
          }

          lastWidth = currentWidth;
        }, 250);
      });
    }

    function generateCurvedConnectors(milestones) {
      const svg = document.querySelector('.timeline-svg');
      if (!svg) return;

      const items = document.querySelectorAll('.timeline-item');
      if (items.length < 2) return;

      // Clear existing paths
      svg.innerHTML = '';

      // Reset SVG styles for desktop
      svg.style.position = 'absolute';
      svg.style.left = '0';
      svg.style.top = '0';
      svg.style.width = '100%';
      svg.style.height = '100%';

      // Get track dimensions
      const track = document.querySelector('.timeline-track');
      const trackRect = track.getBoundingClientRect();

      // Set SVG viewBox to match track dimensions
      svg.setAttribute('width', trackRect.width);
      svg.setAttribute('height', trackRect.height);
      svg.setAttribute('viewBox', `0 0 ${trackRect.width} ${trackRect.height}`);

      // Sort items by their data-index to ensure correct order
      const sortedItems = Array.from(items).sort((a, b) => {
        return parseInt(a.dataset.index) - parseInt(b.dataset.index);
      });

      // Generate paths connecting items in sequential order
      for (let i = 0; i < sortedItems.length - 1; i++) {
        const current = sortedItems[i];
        const next = sortedItems[i + 1];

        const currentDot = current.querySelector('.timeline-dot');
        const nextDot = next.querySelector('.timeline-dot');

        const currentRect = currentDot.getBoundingClientRect();
        const nextRect = nextDot.getBoundingClientRect();

        // Calculate positions relative to track
        const x1 = currentRect.left - trackRect.left + currentRect.width / 2;
        const y1 = currentRect.top - trackRect.top + currentRect.height / 2;
        const x2 = nextRect.left - trackRect.left + nextRect.width / 2;
        const y2 = nextRect.top - trackRect.top + nextRect.height / 2;

        const deltaX = x2 - x1;
        const deltaY = y2 - y1;

        // Create path with rounded corners
        let pathData;
        const cornerRadius = 15;

        if (Math.abs(deltaY) < 5) {
          // Straight horizontal line
          pathData = `M ${x1} ${y1} L ${x2} ${y2}`;
        } else if (Math.abs(deltaX) < 5) {
          // Straight vertical line
          pathData = `M ${x1} ${y1} L ${x2} ${y2}`;
        } else {
          // L-shape with rounded corner
          const midX = x1 + deltaX / 2;

          if (deltaX > 0) {
            // Moving right
            pathData = `M ${x1} ${y1} L ${midX - cornerRadius} ${y1} Q ${midX} ${y1}, ${midX} ${y1 + (deltaY > 0 ? cornerRadius : -cornerRadius)} L ${midX} ${y2 - (deltaY > 0 ? cornerRadius : -cornerRadius)} Q ${midX} ${y2}, ${midX + cornerRadius} ${y2} L ${x2} ${y2}`;
          } else {
            // Moving left or down
            pathData = `M ${x1} ${y1} L ${x1} ${y1 + (deltaY > 0 ? deltaY - cornerRadius : deltaY + cornerRadius)} Q ${x1} ${y1 + deltaY}, ${x1 + (deltaX > 0 ? cornerRadius : -cornerRadius)} ${y1 + deltaY} L ${x2} ${y2}`;
          }
        }

        const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
        path.setAttribute('d', pathData);

        // Color based on both items' status
        const isPast = current.classList.contains('past') && next.classList.contains('past');
        path.classList.add(isPast ? 'past' : 'future');

        svg.appendChild(path);
      }
    }

    function generateVerticalConnectors(milestones) {
      const svg = document.querySelector('.timeline-svg');
      if (!svg) return;

      const items = document.querySelectorAll('.timeline-item');
      if (items.length < 2) return;

      // Clear existing paths
      svg.innerHTML = '';

      const track = document.querySelector('.timeline-track');
      const trackRect = track.getBoundingClientRect();

      // Create one continuous vertical line
      const firstDot = items[0].querySelector('.timeline-dot');
      const lastDot = items[items.length - 1].querySelector('.timeline-dot');

      const firstRect = firstDot.getBoundingClientRect();
      const lastRect = lastDot.getBoundingClientRect();

      const x = 30; // Fixed position from left
      const y1 = firstRect.top - trackRect.top + firstRect.height / 2;
      const y2 = lastRect.top - trackRect.top + lastRect.height / 2;

      const height = y2 - y1 + 100;

      svg.setAttribute('width', '4');
      svg.setAttribute('height', height);
      svg.style.left = '30px';
      svg.style.top = y1 + 'px';

      const pathData = `M 2 0 L 2 ${height}`;

      const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
      path.setAttribute('d', pathData);
      path.setAttribute('stroke', 'rgba(124, 58, 237, 0.4)');
      path.setAttribute('stroke-width', '2');

      svg.appendChild(path);
    }

    function scrollTimeline(direction) {
      const container = document.getElementById('timeline-container');
      const scrollAmount = 400;
      container.scrollBy({
        left: direction === 'left' ? -scrollAmount : scrollAmount,
        behavior: 'smooth'
      });
    }

    function showError() {
      document.getElementById('timeline-container').innerHTML = `
        <div class="timeline-loading">
          <p style="color: var(--danger);">Error al cargar</p>
          <button onclick="location.reload()" style="margin-top: 1rem; padding: 0.75rem 1.5rem; background: #7c3aed; color: white; border: none; border-radius: var(--radius); cursor: pointer;">
            Reintentar
          </button>
        </div>
      `;
    }

    // Menu
    const menuToggle = document.querySelector('.menu-toggle');
    const menu = document.querySelector('.menu');

    if (menuToggle && menu) {
      menuToggle.addEventListener('click', () => {
        const isOpen = menu.classList.toggle('open');
        menuToggle.setAttribute('aria-expanded', String(isOpen));
      });
    }

    // Init
    loadTimeline();
  </script>
</body>
</html>
